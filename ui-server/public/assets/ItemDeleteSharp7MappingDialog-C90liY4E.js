import{bI as e,bQ as i}from"./vendor-TAwwu7tv.js";import{a,c as s,ah as r}from"./layout-C1_h6sDC.js";import{z as t,E as n,B as o,a as l,F as d,c as p,Q as c,O as m,v as g,j as h}from"./mui-core-im59jMHH.js";import{W as u}from"./mui-icons-v3eeVnKX.js";import"./date-utils-hKKKzaQW.js";import"./i18n-BrX_VL2O.js";import"./react-router-B0bL9ISA.js";const f=s(),j=({open:s,mapping:j,onClose:x,onSuccess:b})=>{const{t:C}=a(),[I,v]=e.useState(!1),[y,M]=e.useState(null),$=()=>{M(null),x(!1)};return i.jsxs(t,{open:s,onClose:$,maxWidth:"sm",fullWidth:!0,"data-id-ref":"item-delete-sharp7-mapping-dialog",children:[i.jsx(n,{"data-id-ref":"item-delete-sharp7-mapping-dialog-title",children:i.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[i.jsx(u,{color:"warning"}),i.jsx(l,{variant:"h6",children:C("sharp7Controllers.mappings.dialogs.deleteTitle")})]})}),i.jsxs(d,{"data-id-ref":"item-delete-sharp7-mapping-dialog-content",children:[y&&i.jsx(p,{"data-id-ref":"item-delete-sharp7-mapping-error",severity:"error",onClose:()=>M(null),sx:{mb:2},children:y}),i.jsx(c,{"data-id-ref":"item-delete-sharp7-mapping-confirmation-text",children:(()=>{if(!j)return"";const e=null!==j.bit&&void 0!==j.bit?`${j.position}.${j.bit}`:`${j.position}`,i=`${j.controllerName} (${j.ipAddress} - DB${j.dbAddress})`;return C("itemSharp7Mappings.deleteMessage",{position:e,controller:i})})()})]}),i.jsxs(m,{"data-id-ref":"item-delete-sharp7-mapping-dialog-actions",children:[i.jsx(g,{"data-id-ref":"item-sharp7-cancel-delete-mapping-btn",onClick:$,disabled:I,children:C("common.buttons.cancel")}),i.jsx(g,{"data-id-ref":"item-sharp7-confirm-delete-mapping-btn",onClick:async()=>{if(j&&j.id){v(!0),M(null);try{const e={controllerId:j.controllerId,added:[],changed:[],removed:[j.id]};f.log("Deleting mapping",{mappingId:j.id,position:j.position,bit:j.bit});const i=await r(e);i.isSuccessful?(f.log("Mapping deleted successfully",{mappingId:j.id}),b(C("sharp7Controllers.success.mappingDeleted")),x(!0)):M(i.errorMessage||C("sharp7Controllers.errors.deleteMappingFailed"))}catch(e){f.error("Failed to delete mapping",{error:e}),M(C("sharp7Controllers.errors.deleteMappingFailed"))}finally{v(!1)}}else f.error("Cannot delete mapping: mapping or mapping ID is null")},variant:"contained",color:"error",disabled:I,startIcon:I&&i.jsx(h,{size:20}),children:C(I?"common.loading":"common.buttons.delete")})]})]})};export{j as default};
