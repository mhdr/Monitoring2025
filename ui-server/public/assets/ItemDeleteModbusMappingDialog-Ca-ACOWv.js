import{bI as e,bQ as o}from"./vendor-TAwwu7tv.js";import{a as s,c as i,am as t}from"./layout-C1_h6sDC.js";import{z as a,E as n,B as r,a as d,F as l,c as m,Q as p,O as c,v as g,j as u}from"./mui-core-im59jMHH.js";import{W as b}from"./mui-icons-v3eeVnKX.js";import"./date-utils-hKKKzaQW.js";import"./i18n-BrX_VL2O.js";import"./react-router-B0bL9ISA.js";const f=i(),j=({open:i,mapping:j,onClose:x,onSuccess:h})=>{const{t:C}=s(),[I,y]=e.useState(!1),[M,v]=e.useState(null),F=()=>{v(null),x(!1)};return o.jsxs(a,{open:i,onClose:F,maxWidth:"sm",fullWidth:!0,"data-id-ref":"item-delete-modbus-mapping-dialog",children:[o.jsx(n,{"data-id-ref":"item-delete-modbus-mapping-dialog-title",children:o.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[o.jsx(b,{color:"warning"}),o.jsx(d,{variant:"h6",children:C("modbusControllers.mappings.dialogs.deleteTitle")})]})}),o.jsxs(l,{"data-id-ref":"item-delete-modbus-mapping-dialog-content",children:[M&&o.jsx(m,{"data-id-ref":"item-delete-modbus-mapping-error",severity:"error",onClose:()=>v(null),sx:{mb:2},children:M}),o.jsx(p,{"data-id-ref":"item-delete-modbus-mapping-confirmation-text",children:C("itemModbusMappings.deleteMessage",{position:j?.position??"",controller:j?`${j.controllerName} (${j.ipAddress}:${j.port})`:""})})]}),o.jsxs(c,{"data-id-ref":"item-delete-modbus-mapping-dialog-actions",children:[o.jsx(g,{"data-id-ref":"item-cancel-delete-modbus-mapping-btn",onClick:F,disabled:I,children:C("common.buttons.cancel")}),o.jsx(g,{"data-id-ref":"item-confirm-delete-modbus-mapping-btn",onClick:async()=>{if(j&&j.id){y(!0),v(null);try{const e={controllerId:j.controllerId,added:[],changed:[],removed:[j.id]};f.log("Deleting mapping",{mappingId:j.id,position:j.position});const o=await t(e);o.isSuccessful?(f.log("Mapping deleted successfully",{mappingId:j.id}),h(C("modbusControllers.success.mappingDeleted")),x(!0)):v(o.errorMessage||C("modbusControllers.errors.deleteMappingFailed"))}catch(e){f.error("Failed to delete mapping",{error:e}),v(C("modbusControllers.errors.deleteMappingFailed"))}finally{y(!1)}}else f.error("Cannot delete mapping: mapping or mapping ID is null")},variant:"contained",color:"error",disabled:I,startIcon:I&&o.jsx(u,{size:20}),children:C(I?"common.loading":"common.buttons.delete")})]})]})};export{j as default};
