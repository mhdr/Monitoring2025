import{bI as e,bQ as r}from"./vendor-TAwwu7tv.js";import{u as a}from"./index-uPr0P1lU.js";import{k as s,a as o,O as i,c as t}from"./layout-C1_h6sDC.js";import{C as n,B as d,a as l,aa as p,q as f,r as m,x as c,c as g,t as x,v as w,j as u}from"./mui-core-im59jMHH.js";import{A as h,Y as P}from"./mui-icons-v3eeVnKX.js";import"./date-utils-hKKKzaQW.js";import"./i18n-BrX_VL2O.js";import"./syncfusion-Czakt5fS.js";import"./react-router-B0bL9ISA.js";const b=t(),j=()=>{const{t}=a(),{user:j,logout:v}=s(),{language:y}=o(),[S,N]=e.useState({currentPassword:"",newPassword:"",confirmNewPassword:""}),[W,z]=e.useState({}),[C,I]=e.useState(""),[k,T]=e.useState(""),[B,R]=e.useState(!1),q=()=>{const e={};if(S.currentPassword.trim()||(e.currentPassword=t("profilePage.validation.currentPasswordRequired")),S.newPassword.trim())if(S.newPassword.length<8)e.newPassword=t("profilePage.validation.passwordMinLength");else{const r=/[A-Z]/.test(S.newPassword),a=/[a-z]/.test(S.newPassword),s=/[0-9]/.test(S.newPassword),o=/[!@#$%^&*(),.?":{}|<>]/.test(S.newPassword);r&&a&&s&&o||(e.newPassword=t("profilePage.validation.passwordComplexity"))}else e.newPassword=t("profilePage.validation.newPasswordRequired");return S.confirmNewPassword.trim()?S.newPassword!==S.confirmNewPassword&&(e.confirmNewPassword=t("profilePage.validation.passwordsDoNotMatch")):e.confirmNewPassword=t("profilePage.validation.confirmPasswordRequired"),z(e),0===Object.keys(e).length},F=(e,r)=>{N(a=>({...a,[e]:r})),W[e]&&z(r=>({...r,[e]:void 0})),I(""),T("")};return r.jsxs(n,{maxWidth:!1,sx:{height:"100%",width:"100%",py:"24px",px:0,mx:0},"data-id-ref":"profile-page-container",children:[r.jsxs(d,{sx:{mb:4},"data-id-ref":"profile-page-header",children:[r.jsx(l,{variant:"h4",component:"h1",sx:{fontSize:{xs:"1.35rem",sm:"1.5rem",md:"1.75rem",lg:"2rem"},fontWeight:600,mb:.5},"data-id-ref":"profile-page-title",children:t("profilePage.title")}),r.jsx(l,{variant:"body1",sx:{color:"text.secondary",fontSize:{xs:"0.9rem",sm:"0.95rem",md:"1rem"}},"data-id-ref":"profile-page-subtitle",children:t("profilePage.subtitle")})]}),r.jsxs(p,{container:!0,spacing:3,children:[r.jsx(p,{size:{xs:12,lg:6},children:r.jsx(f,{elevation:2,sx:{height:"100%",borderRadius:{xs:"8px",md:"12px"},transition:"box-shadow 0.3s ease","&:hover":{boxShadow:4}},"data-id-ref":"profile-page-user-info-card",children:r.jsxs(m,{"data-id-ref":"profile-page-user-info-card-body",children:[r.jsxs(l,{variant:"h6",sx:{fontSize:{xs:"1rem",md:"1.125rem",lg:"1.25rem"},fontWeight:600,display:"flex",alignItems:"center",gap:1,mb:4},"data-id-ref":"profile-page-user-info-title",children:[r.jsx(h,{"data-id-ref":"profile-page-user-info-icon"}),t("profilePage.userInfo.title")]}),r.jsxs(d,{className:"user-info-content","data-id-ref":"profile-page-user-info-content",children:[r.jsxs(d,{sx:{padding:{xs:"0.5rem 0",md:"0.75rem 0"},borderBottom:1,borderColor:"divider",mb:3},"data-id-ref":"profile-page-user-info-username-item",children:[r.jsx(l,{component:"label",sx:{display:"block",fontSize:"0.875rem",fontWeight:600,color:"text.secondary",mb:.25,textTransform:"uppercase",letterSpacing:"0.5px"},"data-id-ref":"profile-page-user-info-username-label",children:t("profilePage.userInfo.username")}),r.jsx(l,{sx:{fontSize:{xs:"0.95rem",md:"1rem"},fontWeight:500},"data-id-ref":"profile-page-user-info-username-value",children:j?.userName||"-"})]}),r.jsxs(d,{sx:{padding:{xs:"0.5rem 0",md:"0.75rem 0"},borderBottom:1,borderColor:"divider",mb:3},"data-id-ref":"profile-page-user-info-firstname-item",children:[r.jsx(l,{component:"label",sx:{display:"block",fontSize:"0.875rem",fontWeight:600,color:"text.secondary",mb:.25,textTransform:"uppercase",letterSpacing:"0.5px"},"data-id-ref":"profile-page-user-info-firstname-label",children:t("profilePage.userInfo.firstName")}),r.jsx(l,{sx:{fontSize:{xs:"0.95rem",md:"1rem"},fontWeight:500},"data-id-ref":"profile-page-user-info-firstname-value",children:"fa"===y&&j?.firstNameFa?j.firstNameFa:j?.firstName||"-"})]}),r.jsxs(d,{sx:{padding:{xs:"0.5rem 0",md:"0.75rem 0"},borderBottom:1,borderColor:"divider",mb:3},"data-id-ref":"profile-page-user-info-lastname-item",children:[r.jsx(l,{component:"label",sx:{display:"block",fontSize:"0.875rem",fontWeight:600,color:"text.secondary",mb:.25,textTransform:"uppercase",letterSpacing:"0.5px"},"data-id-ref":"profile-page-user-info-lastname-label",children:t("profilePage.userInfo.lastName")}),r.jsx(l,{sx:{fontSize:{xs:"0.95rem",md:"1rem"},fontWeight:500},"data-id-ref":"profile-page-user-info-lastname-value",children:"fa"===y&&j?.lastNameFa?j.lastNameFa:j?.lastName||"-"})]}),r.jsxs(d,{sx:{padding:{xs:"0.5rem 0",md:"0.75rem 0"}},"data-id-ref":"profile-page-user-info-roles-item",children:[r.jsx(l,{component:"label",sx:{display:"block",fontSize:"0.875rem",fontWeight:600,color:"text.secondary",mb:.25,textTransform:"uppercase",letterSpacing:"0.5px"},"data-id-ref":"profile-page-user-info-roles-label",children:t("profilePage.userInfo.roles")}),r.jsx(d,{"data-id-ref":"profile-page-user-info-roles-value",children:j?.roles&&j.roles.length>0?r.jsx(d,{sx:{display:"flex",flexWrap:"wrap",gap:.5},"data-id-ref":"profile-page-user-info-roles-badges",children:j.roles.map((e,a)=>r.jsx(c,{label:e,color:"primary",size:"small",sx:{fontSize:{xs:"0.8rem",md:"0.875rem"},fontWeight:500,padding:{xs:"0.4rem 0.8rem",md:"0.5rem 1rem"}},"data-id-ref":`profile-page-user-info-role-badge-${a}`},a))}):r.jsx(l,{component:"span","data-id-ref":"profile-page-user-info-no-roles",children:"-"})})]})]})]})})}),r.jsx(p,{size:{xs:12,lg:6},children:r.jsx(f,{elevation:2,sx:{height:"100%",borderRadius:{xs:"8px",md:"12px"},transition:"box-shadow 0.3s ease","&:hover":{boxShadow:4}},"data-id-ref":"profile-page-change-password-card",children:r.jsxs(m,{"data-id-ref":"profile-page-change-password-card-body",children:[r.jsxs(l,{variant:"h6",sx:{fontSize:{xs:"1rem",md:"1.125rem",lg:"1.25rem"},fontWeight:600,display:"flex",alignItems:"center",gap:1,mb:4},"data-id-ref":"profile-page-change-password-title",children:[r.jsx(P,{"data-id-ref":"profile-page-change-password-icon"}),t("profilePage.changePassword.title")]}),r.jsx(l,{variant:"body2",sx:{color:"text.secondary",mb:4},"data-id-ref":"profile-page-change-password-subtitle",children:t("profilePage.changePassword.subtitle")}),C&&r.jsx(g,{severity:"success",onClose:()=>I(""),sx:{mb:2},"data-id-ref":"profile-page-change-password-success-alert",children:C}),k&&r.jsx(g,{severity:"error",onClose:()=>T(""),sx:{mb:2},"data-id-ref":"profile-page-change-password-error-alert",children:k}),r.jsxs(d,{component:"form",onSubmit:async e=>{if(e.preventDefault(),I(""),T(""),q())try{R(!0),(await i({currentPassword:S.currentPassword,newPassword:S.newPassword})).isSuccessful?(I(t("profilePage.messages.changePasswordSuccess")),N({currentPassword:"",newPassword:"",confirmNewPassword:""}),z({}),setTimeout(async()=>{await v()},2e3)):T(t("profilePage.messages.changePasswordError"))}catch(r){b.error("Change password error:",r),R(!1);const e=r;400===e.status||401===e.status?T(t("profilePage.messages.currentPasswordIncorrect")):0===e.status?T(t("profilePage.messages.networkError")):T(e.message||t("profilePage.messages.changePasswordError"))}finally{R(!1)}},"data-id-ref":"profile-page-change-password-form",children:[r.jsx(x,{type:"password",label:t("profilePage.changePassword.currentPassword"),value:S.currentPassword,onChange:e=>F("currentPassword",e.target.value),error:!!W.currentPassword,helperText:W.currentPassword,disabled:B,autoComplete:"current-password",fullWidth:!0,margin:"normal","data-id-ref":"profile-page-change-password-current-input"}),r.jsx(x,{type:"password",label:t("profilePage.changePassword.newPassword"),value:S.newPassword,onChange:e=>F("newPassword",e.target.value),error:!!W.newPassword,helperText:W.newPassword,disabled:B,autoComplete:"new-password",fullWidth:!0,margin:"normal","data-id-ref":"profile-page-change-password-new-input"}),r.jsx(x,{type:"password",label:t("profilePage.changePassword.confirmNewPassword"),value:S.confirmNewPassword,onChange:e=>F("confirmNewPassword",e.target.value),error:!!W.confirmNewPassword,helperText:W.confirmNewPassword,disabled:B,autoComplete:"new-password",fullWidth:!0,margin:"normal","data-id-ref":"profile-page-change-password-confirm-input"}),r.jsxs(d,{sx:{display:"flex",gap:2,mt:3,flexDirection:{xs:"column",sm:"row"}},"data-id-ref":"profile-page-change-password-buttons",children:[r.jsx(w,{variant:"contained",color:"primary",type:"submit",disabled:B,startIcon:B?r.jsx(u,{size:16}):null,sx:{padding:{xs:"0.625rem 1.25rem",md:"0.75rem 1.5rem"},fontWeight:600,transition:"all 0.3s ease","&:hover:not(:disabled)":{transform:"translateY(-2px)"}},"data-id-ref":"profile-page-change-password-submit-button",children:t(B?"loading":"profilePage.changePassword.changePasswordButton")}),r.jsx(w,{variant:"outlined",color:"secondary",type:"button",onClick:()=>{N({currentPassword:"",newPassword:"",confirmNewPassword:""}),z({}),I(""),T("")},disabled:B,sx:{padding:{xs:"0.625rem 1.25rem",md:"0.75rem 1.5rem"},fontWeight:600,transition:"all 0.3s ease","&:hover:not(:disabled)":{transform:"translateY(-2px)"}},"data-id-ref":"profile-page-change-password-cancel-button",children:t("profilePage.changePassword.cancelButton")})]})]})]})})})]})]})};export{j as default};
