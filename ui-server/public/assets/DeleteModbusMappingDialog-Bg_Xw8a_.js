import{bI as e,bQ as s}from"./vendor-TAwwu7tv.js";import{a as o,c as i,am as a}from"./layout-C1_h6sDC.js";import{z as n,E as t,B as d,a as r,F as l,c as m,Q as p,O as c,v as g,j as u}from"./mui-core-im59jMHH.js";import{W as b}from"./mui-icons-v3eeVnKX.js";import"./date-utils-hKKKzaQW.js";import"./i18n-BrX_VL2O.js";import"./react-router-B0bL9ISA.js";const f=i(),j=({open:i,mapping:j,controllerId:x,modbusItems:h,onClose:C,onSuccess:I})=>{const{t:y}=o(),[v,M]=e.useState(!1),[F,S]=e.useState(null),D=()=>{S(null),C(!1)};return s.jsxs(n,{open:i,onClose:D,maxWidth:"sm",fullWidth:!0,"data-id-ref":"delete-modbus-mapping-dialog",children:[s.jsx(t,{"data-id-ref":"delete-modbus-mapping-dialog-title",children:s.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1},children:[s.jsx(b,{color:"warning"}),s.jsx(r,{variant:"h6",children:y("modbusControllers.mappings.dialogs.deleteTitle")})]})}),s.jsxs(l,{"data-id-ref":"delete-modbus-mapping-dialog-content",children:[F&&s.jsx(m,{"data-id-ref":"delete-modbus-mapping-error",severity:"error",onClose:()=>S(null),sx:{mb:2},children:F}),s.jsx(p,{"data-id-ref":"delete-modbus-mapping-confirmation-text",children:y("modbusControllers.mappings.dialogs.deleteMessage",{position:j?.position??"",item:(e=>{const s=h.find(s=>s.id===e);return s?.name||e})(j?.itemId||"")})})]}),s.jsxs(c,{"data-id-ref":"delete-modbus-mapping-dialog-actions",children:[s.jsx(g,{"data-id-ref":"cancel-delete-modbus-mapping-btn",onClick:D,disabled:v,children:y("common.buttons.cancel")}),s.jsx(g,{"data-id-ref":"confirm-delete-modbus-mapping-btn",onClick:async()=>{if(j&&j.id){M(!0),S(null);try{const e={controllerId:x,added:[],changed:[],removed:[j.id]};f.log("Deleting mapping",{mappingId:j.id,position:j.position});const s=await a(e);s.isSuccessful?(f.log("Mapping deleted successfully",{mappingId:j.id}),I(y("modbusControllers.success.mappingDeleted")),C(!0)):S(s.errorMessage||y("modbusControllers.errors.deleteMappingFailed"))}catch(e){f.error("Failed to delete mapping",{error:e}),S(y("modbusControllers.errors.deleteMappingFailed"))}finally{M(!1)}}else f.error("Cannot delete mapping: mapping or mapping ID is null")},variant:"contained",color:"error",disabled:v,startIcon:v&&s.jsx(u,{size:20}),children:y(v?"common.loading":"common.buttons.delete")})]})]})};export{j as default};
